# Open Server, установка #

Часто бывает так, что сервера нет, или деплой не настроен, или необходимо сделать правку в ветке, которую некуда выводить на реальном сервере. Мы заходим в верстку, а верстки толком нет, только куски кода, устаревшие на 2 месяца от реального продакшн сайта.

Что делать? Напрягать программистов, чтобы сделали деплой, поддомен dev.project.com и только тогда можно будет поправить цвет ссылки в футере? Нет, __нужно самим разворачивать локальный сервер, как это делают программисты__. Наша оснавная задача — сделать разницу в познаниях между верстальщиком и программистом минимальной.

Мы все работаем с Open Server. Скачать Open Server можно тут http://open-server.ru/download/. Качаем Basic версию.

Есть 2 варианта работы: в репозитории еще нет ничего, и в репозитории уже есть Престашоп/МодХ. Если в репозитрии нет ничего — обращайтесь к программисту проекта, чтобы он развернул в репу Престашоп/МодХ и сделал все нужные базовые настройки. Без этого никак.

Есть официальная инструкция по установке http://open-server.ru/docs/ .

## Установка Open Server ##

1. Скачиваем архив, запускаем Open Server.exe, в папке будет два файла: x64 и x86 - выбираете в зависимости от разрядности операционки и устанавливаете его в нужную вам папку.
2. Нужно будет открыть настройки сервера и выполнить базовую конфигурацию. Это делается один раз после установки.
    * Создаем папку domains внутри Open Server (если ее нет). Создаем папку репозитория, и клонируем в нее всю репу.
    * Настраиваем модули в Open Server [Settings → Modules]. Ставим версию Апача (согласно разрядности вашей ОС), и последние рабочие версии PHP и MySQL.

    ![alt text](/images/openServerModules.png)

    * Создаем домен, выбрав ручное управление. Выбираем папку, ставим имя домена (не соответствующее папке) и нажимаем Add.

    ![alt text](/images/openServerDomains.png)

    * Стягиваем базу данных по доступам из таска. Запускаем Open Server.

        Если база небольшая, то ее можно вставить так:

        Открываем менеджер MySQL [Advanced → MySQL manager]. Нажимаем Открыть. Теперь мы находимся в Heidi SQL manager. Создаем тут новую базу данных.

    ![alt text](/images/openServerHeidi.png)

        Кликаем на вновь созданную базу данных. Выбираем вкладку Запрос. Открываем файл скачанной ранее базы данных через текстовый редактор. Копируем содержимое, вставляем в поле запроса и нажимаем Выполнить SQL запрос. База вставилась в базу Open Server.

        Если база большая, то ее так просто не вставишь, поэтому делаем следующее:

        Открываем консоль и переходим в папку с Опен Сервером. Переходим в [modules → database → ваша рабочая версия MySQL → bin]. тут лежит exe-шник mysql.exe.

    __mysql -u root__(имя юзера базы) __-ppassword__(пароль базы, если его нет, то этот параметр вообще не пишем) __dbname__(имя базы куда вставляем. Если вы до этого базу в Опен сервере не сделали, то сделайте, иначе не сработает) \< __dump.sql__ (имя базы, котороую импортируем)

    ```
    mysql -u root -ppassword dbname < dump.sql
    ```

    * Настраиваем конфигурации файлов согласно МодХ или Престашоп стандартам ниже.

***

# Престашоп. Разворачивание репозитория в локальном сервере. #

    Если в репе уже есть Преста, то делаем так:

# ModX. Разворачивание репозитория в локальном сервере. #

1. Сделать 4 конфига в стянутом проекте.
    * Главный конфиг находится в папке [core → config] с названием config.inc.php. Во всех 4 папках обычно бывают болванки конфига, у них перед расширением дописано слово sample. Просто копируете их и переименовываете без sample. В этом конфиге нужно прописать всю информацию:

    ```
    $database_type = 'mysql';
    $database_server = 'localhost';
    $database_user = 'root';
    $database_password = '';
    $database_connection_charset = 'utf8';
    ```

        Не все нужно заполнять (если вы не ставили пароли и прочее в вашем Опен Сервере). Нужно лишь заполнить $dbase и изменить имя базы в сборном параметре $database_dsn.

    ![alt text](/images/modxConfig.png)


        Далее вам нужно поменять служебные урлы МодХ к ресурсам ($modx_core_path и прочее). Имейте ввиду, что урлы должны соответствовать папке, в которой лежит ваш домен в опен Сервере. Например у меня это __[F:/open server/OpenServer/domains/fotobook.club/]__.

    * Еще три конфига с названием config.core.php в корневой папке, папке [manager] (managersite) и папке connectors. Они все одинаковые, так что можно любую болванку взять из этих 3 папок. Там нужно поменять урл, как вы это делали в файле выше ([core → config] config.inc.php).
2. Запускаем сервер - в трее будет красный флажок. Клацаем по нему - отроется меню и в нем будет пункт __Run server__. Нажимаем на него и если все ок, то флажок будет зеленый. Сервер запущен.
3. Открываем домен в браузере [My sites → ваш домен].

__Важно__ Не забудьте удалить все из папки core/cache, иначе ничего не будет работать.